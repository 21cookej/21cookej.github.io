<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Sound Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #1f1f1f;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      flex-direction: column;
    }

    .container {
      text-align: center;
      padding: 20px;
      border: 2px solid #4e4e4e;
      border-radius: 10px;
      background-color: #2c2c2c;
      width: 500px;
    }

    label {
      display: block;
      font-size: 16px;
      margin: 10px 0;
    }

    input[type="range"] {
      width: 60%;
      margin: 10px 0;
    }

    select {
      width: 40%;
      margin: 10px;
      padding: 5px;
      background-color: #3c3c3c;
      color: white;
      border: 1px solid #5a5a5a;
      border-radius: 5px;
      font-size: 16px;
    }

    .file-input-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin: 10px 0;
    }

    input[type="file"] {
      background-color: #2c2c2c;
      color: white;
      border: 1px solid #4e4e4e;
      border-radius: 5px;
      cursor: pointer;
      padding: 5px;
      flex: 1;
    }

    button {
      padding: 10px;
      background-color: #3c3c3c;
      color: white;
      border: 1px solid #5a5a5a;
      cursor: pointer;
      border-radius: 5px;
      margin-left: 10px;
    }

    button:hover {
      background-color: #4e4e4e;
    }

    .output {
      margin-top: 20px;
    }

    .error {
      color: red;
      font-size: 14px;
      margin-top: 10px;
    }

    .inline {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .inline label {
      margin: 0 10px 0 0;
    }

    .inline select, .inline input[type="range"] {
      margin: 0 10px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>Custom Sound Generator</h1>

    <div class="inline">
      <label for="frequency">Frequency:</label>
      <input type="range" id="frequency" min="20" max="24000" value="440">
      <span id="freq-value">440 Hz</span>
    </div>

    <div class="inline">
      <label for="waveform">Waveform:</label>
      <select id="waveform">
        <option value="sine">Sine</option>
        <option value="square">Square</option>
        <option value="triangle">Triangle</option>
        <option value="sawtooth">Sawtooth</option>
      </select>
    </div>

    <div class="file-input-container">
      <label for="file-input">Import Custom Sound:</label>
      <input type="file" id="file-input" accept="audio/*,video/*">
      <button id="add-sound">Import</button>
    </div>
    <p class="error" id="error-msg"></p>

    <div class="output">
      <p>Current Frequency: <span id="current-frequency">440 Hz</span></p>
      <p>Current Waveform: <span id="current-waveform">Sine</span></p>
    </div>

    <div class="inline">
      <label for="volume">Volume:</label>
      <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
      <span id="volume-value">100%</span>
    </div>

    <button id="toggle">Start</button>
  </div>

  <script>
    let audioContext = new (window.AudioContext || window.webkitAudioContext)();
    let oscillator = null;
    let audioBufferSource = null;
    let isPlaying = false;

    const frequencyInput = document.getElementById("frequency");
    const waveformSelect = document.getElementById("waveform");
    const fileInput = document.getElementById("file-input");
    const addSoundButton = document.getElementById("add-sound");
    const toggleButton = document.getElementById("toggle");
    const volumeInput = document.getElementById("volume");
    const freqValueDisplay = document.getElementById("freq-value");
    const currentFreqDisplay = document.getElementById("current-frequency");
    const currentWaveformDisplay = document.getElementById("current-waveform");
    const volumeValueDisplay = document.getElementById("volume-value");

    frequencyInput.addEventListener("input", updateFrequency);
    waveformSelect.addEventListener("change", updateWaveform);
    toggleButton.addEventListener("click", toggleTone);
    addSoundButton.addEventListener("click", importCustomSound);
    volumeInput.addEventListener("input", updateVolume);

    function updateFrequency() {
      const frequency = frequencyInput.value;
      freqValueDisplay.textContent = `${frequency} Hz`;
      currentFreqDisplay.textContent = `${frequency} Hz`;
      if (oscillator && isPlaying) {
        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
      }
    }

    function updateWaveform() {
      const waveform = waveformSelect.value;
      currentWaveformDisplay.textContent = waveform.charAt(0).toUpperCase() + waveform.slice(1);
      if (oscillator && isPlaying) {
        oscillator.type = waveform;
      }
    }

    function updateVolume() {
      const volume = volumeInput.value;
      volumeValueDisplay.textContent = `${Math.round(volume * 100)}%`;
      if (oscillator && isPlaying) {
        oscillator.connect(audioContext.destination);
        audioContext.destination.gain.setValueAtTime(volume, audioContext.currentTime);
      }
    }

    function toggleTone() {
      if (isPlaying) {
        stopTone();
      } else {
        startTone();
      }
    }

    function startTone() {
      oscillator = audioContext.createOscillator();
      const waveform = waveformSelect.value;
      oscillator.type = waveform;
      oscillator.frequency.setValueAtTime(frequencyInput.value, audioContext.currentTime);

      const gainNode = audioContext.createGain();
      gainNode.gain.setValueAtTime(volumeInput.value, audioContext.currentTime);

      oscillator.connect(gainNode).connect(audioContext.destination);
      oscillator.start();
      toggleButton.textContent = "Stop";
      isPlaying = true;
    }

    function stopTone() {
      oscillator.stop();
      toggleButton.textContent = "Start";
      isPlaying = false;
    }

    function importCustomSound() {
      const file = fileInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          audioContext.decodeAudioData(e.target.result, function(buffer) {
            audioBufferSource = audioContext.createBufferSource();
            audioBufferSource.buffer = buffer;
            audioBufferSource.connect(audioContext.destination);
            audioBufferSource.loop = true; // Automatic looping
            audioBufferSource.start();
          });
        };
        reader.readAsArrayBuffer(file);
      }
    }
  </script>

</body>
</html>
